/*!@license
* Infragistics.Web.ClientUI Spreadsheet 17.1.20171.2002
*
* Copyright (c) 2015-2017 Infragistics Inc.
*
* http://www.infragistics.com/
*
* Depends on:
* jquery.js
* jquery-ui.js
* infragistics.util.js
* infragistics.util.jquery.js
* infragistics.ext_core.js
* infragistics.ext_collections.js
* infragistics.ext_collectionsExtended.js
* infragistics.ext_io.js
* infragistics.ext_text.js
* infragistics.ext_web.js
* infragistics.xml.js
* infragistics.documents.core_core.js
* infragistics.documents.core_openxml.js
* infragistics.dv_core.js
* infragistics.dv_jquerydom.js
* infragistics.excel_core.js
* infragistics.ext_ui.js
* infragistics.undo.js
* infragistics.spreadsheet.js
*/
if(typeof jQuery==="undefined"){throw new Error("jQuery is undefined")}(function($){$.widget("ui.igSpreadsheet",{css:{unsupportedBrowserClass:"ui-html5-non-html5-supported-message ui-helper-clearfix ui-html5-non-html5",spreadsheet:"ui-igspreadsheet",tooltip:"ui-igspreadsheet-tooltip ui-tooltip ui-widget-content ui-corner-all",selectAll:"ui-igspreadsheet-selectall",rowSplitter:"ui-igspreadsheet-rowsplitter",columnSplitter:"ui-igspreadsheet-columnsplitter",rowSplitterPreview:"ui-igspreadsheet-rowsplitterpreview",columnSplitterPreview:"ui-igspreadsheet-columnsplitterpreview",splitterIntersection:"ui-igspreadsheet-splitterintersection",rowHeaderArea:"ui-igspreadsheet-rowheaderarea",columnHeaderArea:"ui-igspreadsheet-columnheaderarea",tabAreaSplitter:"ui-igspreadsheet-tabareasplitter",tabAreaBackground:"ui-igspreadsheet-tabareabackground",tabAreaBorder:"ui-igspreadsheet-tabareaborder",tabItem:"ui-igspreadsheet-tabitem",tabItemActive:"ui-igspreadsheet-tabitem-active",tabItemSelected:"ui-igspreadsheet-tabitem-selected",tabItemProtected:"ui-igspreadsheet-tabitem-protected",tabItemContent:"ui-igspreadsheet-tabitemcontent",tabItemDark:"ui-igspreadsheet-tabitem-dark",tabItemLight:"ui-igspreadsheet-tabitem-light",tabItemArea:"ui-igspreadsheet-tabitemarea",tabDropIndicator:"ui-igspreadsheet-tabDropIndicator",scrollFirstTabButton:"ui-igspreadsheet-scrollfirsttab",scrollPreviousTabButton:"ui-igspreadsheet-scrollprevioustab",scrollLastTabButton:"ui-igspreadsheet-scrolllasttab",scrollNextTabButton:"ui-igspreadsheet-scrollnexttab",activateNextHiddenTabButton:"ui-igspreadsheet-activatenexthiddentab",activatePreviousHiddenTabButton:"ui-igspreadsheet-activateprevioushiddentab",addNewWorksheetButton:"ui-igspreadsheet-addnewworksheet",inputMessage:"ui-igspreadsheet-inputmessage",inputMessageContent:"ui-igspreadsheet-inputmessage-content",inputMessageTitle:"ui-igspreadsheet-inputmessage-title",scrollBarVertical:"ui-igspreadsheet-scrollbar-vertical",scrollBarHorizontal:"ui-igspreadsheet-scrollbar-horizontal",scrollBarArrowLeft:"ui-igspreadsheet-scrollbar-button-left",scrollBarArrowRight:"ui-igspreadsheet-scrollbar-button-right",scrollBarArrowUp:"ui-igspreadsheet-scrollbar-button-up",scrollBarArrowDown:"ui-igspreadsheet-scrollbar-button-down",scrollBarTrackLeft:"ui-igspreadsheet-scrollbar-track-left",scrollBarTrackRight:"ui-igspreadsheet-scrollbar-track-right",scrollBarTrackUp:"ui-igspreadsheet-scrollbar-track-up",scrollBarTrackDown:"ui-igspreadsheet-scrollbar-track-down",scrollBarThumbVertical:"ui-igspreadsheet-scrollbar-thumb-vertical",scrollBarThumbHorizontal:"ui-igspreadsheet-scrollbar-thumb-horizontal",columnHeader:"ui-igspreadsheet-columnheader",columnHeaderSelected:"ui-igspreadsheet-columnheader-selected",columnHeaderSelectedCells:"ui-igspreadsheet-columnheader-selectedcells",columnHeaderHover:"ui-igspreadsheet-columnheader-hover",rowHeader:"ui-igspreadsheet-rowheader",rowHeaderSelected:"ui-igspreadsheet-rowheader-selected",rowHeaderSelectedCells:"ui-igspreadsheet-rowheader-selectedcells",rowHeaderHover:"ui-igspreadsheet-rowheader-hover",automaticGridline:"ui-igspreadsheet-automaticgridline",invalidData:"ui-igspreadsheet-invaliddata",headerResizeLine:"ui-igspreadsheet-header-resizeline",cellSelection:"ui-igspreadsheet-cellselection",cellSelectionHandle:"ui-igspreadsheet-cellselectionhandle",formulaBar:"ui-igspreadsheet-formulabar",nameBoxContainer:"ui-igspreadsheet-nameboxcontainer",nameBoxSplitter:"ui-igspreadsheet-nameboxsplitter",formulaBarTextAreaContainer:"ui-igspreadsheet-formulabartextareacontainer",formulaBarTextAreaSplitter:"ui-igspreadsheet-formulabartextareasplitter",formulaBarButtonContainer:"ui-igspreadsheet-formulabarbuttoncontainer",formulaBarEnterButton:"ui-igspreadsheet-formulabarenterbutton",formulaBarCancelButton:"ui-igspreadsheet-formulabarcancelbutton",formulaBarExpandButton:"ui-igspreadsheet-formulabarexpandbutton",formulaBarExpandButtonOpen:"ui-igspreadsheet-formulabarexpandbutton-open"},events:{actionExecuted:null,actionExecuting:null,activeCellChanged:null,activePaneChanged:null,activeWorksheetChanged:null,editRangePasswordNeeded:null,hyperlinkExecuting:null,selectionChanged:null,userPromptDisplaying:null,workbookDirtied:null},options:{width:null,height:null,activeCell:null,isScrollLocked:null,activeWorksheet:null,allowAddWorksheet:true,allowDeleteWorksheet:true,areGridlinesVisible:true,areHeadersVisible:true,enterKeyNavigationDirection:"down",isEnterKeyNavigationEnabled:true,isFormulaBarVisible:true,isInEndMode:false,isUndoEnabled:true,nameBoxWidth:102,selectionMode:"normal",selectedWorksheets:null,validationInputMessagePosition:null,workbook:null,zoomLevel:100},_setOption:function(key,value,checkPrev){var spreadsheet=this._spreadsheet,o=this.options;if(checkPrev&&o[key]===value){return}$.Widget.prototype._setOption.apply(this,arguments);if(this._set_option(spreadsheet,key,value)){return this}return this},_set_generated_option:function(spreadsheet,key,value){switch(key){case"isScrollLocked":spreadsheet.isScrollLocked(value);return true;case"activeWorksheet":spreadsheet.activeWorksheet(value);return true;case"allowAddWorksheet":spreadsheet.allowAddWorksheet(value);return true;case"allowDeleteWorksheet":spreadsheet.allowDeleteWorksheet(value);return true;case"areGridlinesVisible":spreadsheet.areGridlinesVisible(value);return true;case"areHeadersVisible":spreadsheet.areHeadersVisible(value);return true;case"enterKeyNavigationDirection":switch(value){case"down":spreadsheet.enterKeyNavigationDirection(0);break;case"right":spreadsheet.enterKeyNavigationDirection(1);break;case"up":spreadsheet.enterKeyNavigationDirection(2);break;case"left":spreadsheet.enterKeyNavigationDirection(3);break}return true;case"isEnterKeyNavigationEnabled":spreadsheet.isEnterKeyNavigationEnabled(value);return true;case"isFormulaBarVisible":spreadsheet.isFormulaBarVisible(value);return true;case"isInEndMode":spreadsheet.isInEndMode(value);return true;case"isUndoEnabled":spreadsheet.isUndoEnabled(value);return true;case"nameBoxWidth":spreadsheet.nameBoxWidth(value);return true;case"selectionMode":switch(value){case"normal":spreadsheet.selectionMode(0);break;case"extendSelection":spreadsheet.selectionMode(1);break;case"addToSelection":spreadsheet.selectionMode(2);break}return true;case"selectedWorksheets":spreadsheet.selectedWorksheets(value);return true;case"workbook":spreadsheet.workbook(value);return true;case"zoomLevel":spreadsheet.zoomLevel(value);return true}},_set_option:function(spreadsheet,key,value){var self=this;var currentKey;switch(key){case"width":this._setSize(spreadsheet,"width",value);return true;case"height":this._setSize(spreadsheet,"height",value);return true;case"validationInputMessagePosition":if(value===null)spreadsheet.validationInputMessagePosition(null);else spreadsheet.validationInputMessagePosition($.ig.APIFactory.prototype.createPoint(value.x,value.y));return true;case"activeCell":value=typeof value==="object"?value.toString():value+"";spreadsheet.activeCellAddress(value);return true;default:if(this._set_generated_option(spreadsheet,key,value))return true;return false}},_creationOptions:null,_spreadsheet:null,_menuPropertyChangeHandlers:null,_createWidget:function(options,element,widget){this._creationOptions=options;$.Widget.prototype._createWidget.apply(this,[options,element])},_create:function(){var key,v,size,spreadsheet,width,height,i=-1,self=this,elem=self.element,style=elem[0].style,o=this._creationOptions;self._old_state={style:{position:style.position,width:style.width,height:style.height,visibility:style.visibility},css:elem[0].className,elems:elem.find("*")};if(!$.ig.util._isCanvasSupported()){$.ig.util._renderUnsupportedBrowser(this);return}spreadsheet=this._createSpreadsheet();self._spreadsheet=spreadsheet;self._spreadsheetPropertyChangeHandlers={};self._spreadsheetPropertyChangeHandlers["ActiveCell"]=function(spreadsheet){this.options.activeCell=spreadsheet.activeCellAddress()};self._spreadsheetPropertyChangeHandlers["ActiveWorksheet"]=function(spreadsheet){this.options.activeWorksheet=spreadsheet.activeWorksheet()};self._spreadsheetPropertyChangeHandlers["AreGridlinesVisible"]=function(spreadsheet){this.options.areGridlinesVisible=spreadsheet.areGridlinesVisible()};self._spreadsheetPropertyChangeHandlers["AreHeadersVisible"]=function(spreadsheet){this.options.areHeadersVisible=spreadsheet.areHeadersVisible()};self._spreadsheetPropertyChangeHandlers["IsFormulaBarVisible"]=function(spreadsheet){this.options.isFormulaBarVisible=spreadsheet.isFormulaBarVisible()};self._spreadsheetPropertyChangeHandlers["IsInEndMode"]=function(spreadsheet){this.options.isInEndMode=spreadsheet.isInEndMode()};self._spreadsheetPropertyChangeHandlers["NameBoxWidth"]=function(spreadsheet){this.options.nameBoxWidth=spreadsheet.nameBoxWidth()};self._spreadsheetPropertyChangeHandlers["SelectedWorksheets"]=function(spreadsheet){this.options.selectedWorksheets=spreadsheet.selectedWorksheets()};self._spreadsheetPropertyChangeHandlers["SelectionMode"]=function(spreadsheet){this.options.selectionMode=spreadsheet.selectionMode()};self._spreadsheetPropertyChangeHandlers["ValidationInputMessagePosition"]=function(spreadsheet){var point=spreadsheet.validationInputMessagePosition();var newValue=null;if(point!==null){newValue={x:point.__x,y:point.__y}}this.options.validationInputMessagePosition=newValue};self._spreadsheetPropertyChangeHandlers["Workbook"]=function(spreadsheet){this.options.workbook=spreadsheet.workbook()};self._spreadsheetPropertyChangeHandlers["ZoomLevel"]=function(spreadsheet){this.options.zoomLevel=spreadsheet.zoomLevel()};spreadsheet.propertyChanged=$.ig.Delegate.prototype.combine(spreadsheet.propertyChanged,jQuery.proxy(this._onSpreadsheetPropChanged,this));spreadsheet.actionExecuted=$.ig.Delegate.prototype.combine(spreadsheet.actionExecuted,$.proxy(this._fireSpreadsheet_actionExecuted,this));spreadsheet.actionExecuting=$.ig.Delegate.prototype.combine(spreadsheet.actionExecuting,$.proxy(this._fireSpreadsheet_actionExecuting,this));spreadsheet.activeCellChanged=$.ig.Delegate.prototype.combine(spreadsheet.activeCellChanged,$.proxy(this._fireSpreadsheet_activeCellChanged,this));spreadsheet.activePaneChanged=$.ig.Delegate.prototype.combine(spreadsheet.activePaneChanged,$.proxy(this._fireSpreadsheet_activePaneChanged,this));spreadsheet.activeWorksheetChanged=$.ig.Delegate.prototype.combine(spreadsheet.activeWorksheetChanged,$.proxy(this._fireSpreadsheet_activeWorksheetChanged,this));spreadsheet.editRangePasswordNeeded=$.ig.Delegate.prototype.combine(spreadsheet.editRangePasswordNeeded,$.proxy(this._fireSpreadsheet_editRangePasswordNeeded,this));spreadsheet.hyperlinkExecuting=$.ig.Delegate.prototype.combine(spreadsheet.hyperlinkExecuting,$.proxy(this._fireSpreadsheet_hyperlinkExecuting,this));spreadsheet.selectionChanged=$.ig.Delegate.prototype.combine(spreadsheet.selectionChanged,$.proxy(this._fireSpreadsheet_selectionChanged,this));spreadsheet.userPromptDisplaying=$.ig.Delegate.prototype.combine(spreadsheet.userPromptDisplaying,$.proxy(this._fireSpreadsheet_userPromptDisplaying,this));spreadsheet.workbookDirtied=$.ig.Delegate.prototype.combine(spreadsheet.workbookDirtied,$.proxy(this._fireSpreadsheet_workbookDirtied,this));if(o.hasOwnProperty("width"))elem[0].style.width=o["width"];if(o.hasOwnProperty("height"))elem[0].style.height=o["height"];var elemWrapper=new $.ig.JQueryDomWrapper(elem[0],elem);var renderer=new $.ig.JQueryDomRenderer(elemWrapper);spreadsheet.css=this.css;spreadsheet.provideContainer(renderer);for(key in o){if(o.hasOwnProperty(key)){v=o[key];if(v!==null){this._setOption(key,v,false)}}}while(i++<1){key=i===0?"width":"height";if(o[key]){size=key;v=o[key]}else{v=elem[0].style[key]}if(v&&v.indexOf("%")>0){self._setSize(spreadsheet,size=key,v)}}if(!size){self._setSize(spreadsheet,"width")}if(self.css&&self.css.spreadsheet){elem.addClass(self.css.spreadsheet)}spreadsheet.onInitialized()},_createSpreadsheet:function(){return new $.ig.Spreadsheet},_onSpreadsheetPropChanged:function(spreadsheet,evt){var handler=this._spreadsheetPropertyChangeHandlers[evt._propertyName];if(handler)handler.call(this,spreadsheet)},_fireSpreadsheet_actionExecuted:function(spreadsheet,evt){var opts={};opts.owner=this;opts.action=$.ig.spreadsheet.SpreadsheetAction.prototype.$getName(evt.command());this._trigger("actionExecuted",null,opts)},_fireSpreadsheet_actionExecuting:function(spreadsheet,evt){var opts={};opts.owner=this;opts.action=$.ig.spreadsheet.SpreadsheetAction.prototype.$getName(evt.command());if(!this._trigger("actionExecuting",null,opts)){evt.cancel(true)}},_fireSpreadsheet_activeCellChanged:function(spreadsheet,evt){var opts={};opts.owner=this;opts.oldValue=evt.oldValue().toString();opts.newValue=evt.newValue().toString();this._trigger("activeCellChanged",null,opts)},_fireSpreadsheet_activePaneChanged:function(spreadsheet,evt){var opts={};opts.owner=this;opts.oldActivePane=evt.oldValue();opts.newActivePane=evt.newValue();opts.activeCell=opts.newActivePane!=null?opts.newActivePane.selection().activeCell().toString():null;opts.visibleRange=opts.newActivePane!=null?opts.newActivePane.visibleRange().toString():null;this._trigger("activePaneChanged",null,opts)},_fireSpreadsheet_activeWorksheetChanged:function(spreadsheet,evt){var opts={};opts.owner=this;opts.oldActiveWorksheet=evt.oldValue();opts.oldActiveWorksheetName=opts.oldActiveWorksheet!=null?opts.oldActiveWorksheet.name():null;opts.newActiveWorksheet=evt.newValue();opts.newActiveWorksheetName=opts.newActiveWorksheet!=null?opts.newActiveWorksheet.name():null;this._trigger("activeWorksheetChanged",null,opts)},_fireSpreadsheet_editModeExiting:function(spreadsheet,evt){var noCancel,opts={};opts.owner=this;opts.acceptChanges=evt.acceptChanges();opts.canCancel=evt.canCancel();opts.cell=evt.cell().toString();noCancel=this._trigger("editModeExiting",null,opts);evt.acceptChanges(opts.acceptChanges);if(!noCancel){evt.cancel(true)}},_fireSpreadsheet_editModeExited:function(spreadsheet,evt){var opts={};opts.owner=this;opts.cell=evt.cell().toString();this._trigger("editModeExited",null,opts)},_fireSpreadsheet_editModeEntering:function(spreadsheet,evt){var opts={};opts.owner=this;opts.cell=evt.cell().toString();if(!this._trigger("editModeEntering",null,opts)){evt.cancel(true)}},_fireSpreadsheet_editModeEntered:function(spreadsheet,evt){var opts={};opts.owner=this;opts.cell=evt.cell().toString();this._trigger("editModeEntered",null,opts)},_fireSpreadsheet_editModeValidationError:function(spreadsheet,evt){var opts={};opts.owner=this;opts.action=$.ig.spreadsheet.SpreadsheetEditModeValidationErrorAction.prototype.$getName(evt.action());opts.canStayInEditMode=evt.canStayInEditMode();opts.cell=evt.cell().toString();opts.validationRule=evt.validationRule();this._trigger("editModeValidationError",null,opts);var newAction=opts.action;if(typeof newAction==="string")newAction=$.ig.util.getEnumValue($.ig.Enum.prototype.parse($.ig.spreadsheet.SpreadsheetEditModeValidationErrorAction.prototype.$type,newAction,true));evt.action(newAction)},_fireSpreadsheet_editRangePasswordNeeded:function(spreadsheet,evt){var opts={};opts.owner=this;opts.ranges=evt._getRangesArray();opts.unprotect=evt.unprotect();if(!this._trigger("editRangePasswordNeeded",null,opts)){evt.cancel(true)}},_fireSpreadsheet_hyperlinkExecuting:function(spreadsheet,evt){var noCancel,opts={};opts.owner=this;opts.hyperlink=evt.hyperlink();noCancel=this._trigger("hyperlinkExecuting",null,opts);if(!noCancel){evt.cancel(true)}},_fireSpreadsheet_selectionChanged:function(spreadsheet,evt){var opts={};opts.owner=this;opts.pane=evt.pane();this._trigger("selectionChanged",null,opts)},_fireSpreadsheet_userPromptDisplaying:function(spreadsheet,evt){var noCancel,opts={};opts.owner=this;opts.canCancel=evt.canCancel();opts.displayMessage=evt.displayMessage();opts.exception=evt.exception();opts.message=evt.message();opts.trigger=$.ig.spreadsheet.SpreadsheetUserPromptTrigger.prototype.$getName(evt.trigger());noCancel=this._trigger("userPromptDisplaying",null,opts);evt.displayMessage(opts.displayMessage);evt.message(opts.message);if(!noCancel){evt.cancel(true)}},_fireSpreadsheet_workbookDirtied:function(spreadsheet,evt){var opts={};opts.owner=this;this._trigger("workbookDirtied",null,opts)},_setSize:function(spreadsheet,key,val){$.ig.util.setSize(this.element,key,val,spreadsheet,this._getNotifyResizeName())},_getNotifyResizeName:function(){return"containerResized"},getActivePane:function(){if(this._spreadsheet)return this._spreadsheet.activePane();return null},getActiveSelection:function(){if(this._spreadsheet)return this._spreadsheet.activeSelection();return null},getActiveSelectionCellRangeFormat:function(){if(this._spreadsheet)return this._spreadsheet.activeSelectionCellRangeFormat();return null},_getCellEditMode:function(){if(this._spreadsheet)return this._spreadsheet.cellEditMode();return null},_getIsInEditMode:function(){if(this._spreadsheet)return this._spreadsheet.isInEditMode();return null},getIsRenamingWorksheet:function(){if(this._spreadsheet)return this._spreadsheet.isRenamingWorksheet();return null},getPanes:function(){if(this._spreadsheet)return this._spreadsheet._getPanesAsArray();return null},executeAction:function(action){if(this._spreadsheet){var cmd=action;if(typeof cmd==="string")cmd=$.ig.util.getEnumValue($.ig.Enum.prototype.parse($.ig.spreadsheet.SpreadsheetAction.prototype.$type,cmd,true));return this._spreadsheet.executeCommand(cmd)}return false},flush:function(){if(this._spreadsheet&&this._spreadsheet.flush)this._spreadsheet.flush()},destroy:function(){var key,style,spreadsheet=this._spreadsheet,old=this._old_state,elem=this.element;if(!old){return}elem.find("*").not(old.elems).remove();if(this.css.spreadsheet){elem.removeClass(this.css.spreadsheet)}old=old.style;style=elem[0].style;for(key in old){if(old.hasOwnProperty(key)){if(style[key]!==old[key]){style[key]=old[key]}}}if(spreadsheet){this._setSize(spreadsheet)}$.Widget.prototype.destroy.apply(this,arguments);if(spreadsheet&&spreadsheet.destroy){spreadsheet.destroy()}delete this._spreadsheet;delete this._old_state},styleUpdated:function(){if(this._spreadsheet){this._spreadsheet.styleUpdated()}}});$.extend($.ui.igSpreadsheet,{version:"17.1.20171.2002"})})(jQuery);